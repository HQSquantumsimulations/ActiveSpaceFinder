

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Code documentation &mdash; ASF 0.19 pre-alpha documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials" href="tutorials/examples.html" />
    <link rel="prev" title="Welcome to the documentation for ASF!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="index.html" class="icon icon-home"> ASF
          

          
            
            <img src="_static/HQS.jpg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.19 pre-alpha
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/examples.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ASF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Code documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/modules.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="code-documentation">
<h1>Code documentation<a class="headerlink" href="#code-documentation" title="Permalink to this headline">Â¶</a></h1>
<dl class="py class">
<dt id="asf.asf">
<em class="property">class </em><code class="sig-prename descclassname">asf.</code><code class="sig-name descname">asf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">DMRG_M</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Union<span class="p">[</span>int<span class="p">, </span>List<span class="p">[</span>int<span class="p">]</span><span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">DMRG_S</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Union<span class="p">[</span>int<span class="p">, </span>list<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">DMRG_tol</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Union<span class="p">[</span>float<span class="p">, </span>list<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">DMRG_N</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Union<span class="p">[</span>float<span class="p">, </span>list<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">DMRG_MaxM</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">DMRG_SM</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tdod</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">restart</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nthreads</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">entropies</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">run_dmrg_flag</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fontsize2</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">loc</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fancybox</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">default_color</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tolerance</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mc</span><span class="p">:</span> <span class="n">pyscf.mcscf.casci.CASCI</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">no</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">occ</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">memory</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dbug</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">dcolor</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename_nat</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">filename_ent</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">idxshift</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">p_thresh</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span>dict<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.asf" title="Permalink to this definition">Â¶</a></dt>
<dd><dl class="py method">
<dt id="asf.asf.calculate_criteria">
<code class="sig-name descname">calculate_criteria</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nat_occ</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">weight</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">we_sc</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">clipping</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">Th_auto</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'HQS'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.asf.calculate_criteria" title="Permalink to this definition">Â¶</a></dt>
<dd><p>automatic selection of the threshold. The automatgic generation
of threshold is different for occupied and virtual (empty) orbitals. Singly
occupied threshold is set as occupied, however, they are always selected
unless you switch singles to off.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nat_occ</strong> (<em>list</em>) â Natural orbital occupation numbers.</p></li>
<li><p><strong>weight</strong> (<em>bool</em>) â Factor in weights of occupied and unoccupied orbitals in
threshold calculation.</p></li>
<li><p><strong>we_sc</strong> (<em>float</em>) â The scale to which weight is considered.
Check the equation below.</p></li>
<li><p><strong>clipping</strong> (<em>bool</em>) â Clipping the very small values from the occupation list.
This helps with setting a proper threshold.</p></li>
<li><p><strong>Th_auto</strong> (<em>str</em>) â The choices of automated threshold selection.
âHQSâ default.
âSTDâ stanorredard deviation is used.
âAVGâ average value is used.
âMinâ Minimum of above.
âMaxâ Max of above.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary for containing calculated criteriaâs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>crit (dict)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> â look up the error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="asf.asf.dm">
<code class="sig-name descname">dm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mc</span><span class="p">:</span> <span class="n">pyscf.mcscf.casci.CASCI</span></em>, <em class="sig-param"><span class="n">mo</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">root</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>list<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#asf.asf.dm" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calculate orbdesn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mc</strong> (<em>CASCIClass</em>) â PySCF mc object.</p></li>
<li><p><strong>mo</strong> (<em>list</em>) â Do not use this.
Specified orbitals for rdm calculations.
This is a list of orbitals for each root.
If only one root the a one membered (np.ndarray) list.</p></li>
<li><p><strong>root</strong> (<em>int/list</em>) â Calculate for a specific root(int) or roots(list).
Otherwise for all roots.
In that case mo should be None or list of orbs for all
roots.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Orbital desnity required for entanglement</dt><dd><p>calculations.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>orbdens (list)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Exception</strong> â wrong inputs.</p></li>
<li><p><strong>ValueError</strong> â Look up errors.</p></li>
<li><p><strong>NotImplementedError</strong> â Do not use this feature in this version.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="asf.asf.eval_ss_entropy">
<code class="sig-name descname">eval_ss_entropy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dm</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#asf.asf.eval_ss_entropy" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Function which evaluates the single site entropy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dm</strong> (<em>np.array</em>) â Density matrix of active orbitals.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The single site entropy.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>s (np.array)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> â look up errors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="asf.asf.eval_ss_entropy_wrapper">
<code class="sig-name descname">eval_ss_entropy_wrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mc</span><span class="p">:</span> <span class="n">pyscf.mcscf.casci.CASCI</span></em>, <em class="sig-param"><span class="n">mo</span><span class="p">:</span> <span class="n">numpy.ndarray</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">root</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#asf.asf.eval_ss_entropy_wrapper" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Wrapper for entropy calculation functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mc</strong> (<em>CASCIClass</em>) â PySCF mc object.</p></li>
<li><p><strong>mo</strong> (<em>array</em>) â Do not use this feature.
Specific orbitals for rdm calculations.</p></li>
<li><p><strong>root</strong> (<em>int</em>) â Calculate for a specific root(int) or roots(list).
Otherwise for all roots.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The single site entropy for the given MO.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>s (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="asf.asf.fas_no_guess">
<code class="sig-name descname">fas_no_guess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mf</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>pyscf.scf.uhf.UHF<span class="p">, </span>pyscf.scf.hf.RHF<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">nat_type</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'MP2'</span></em>, <em class="sig-param"><span class="n">machine_limit</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">30</span></em>, <em class="sig-param"><span class="n">symm</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">Th_auto_nat</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'HQS'</span></em>, <em class="sig-param"><span class="n">Th_auto_DMRG</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'HQS'</span></em>, <em class="sig-param"><span class="n">converge_</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">add_orb_id</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Ms</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">MaxM</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">2000</span></em>, <em class="sig-param"><span class="n">init_M</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">31</span></em>, <em class="sig-param"><span class="n">init_S</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">Max_iter</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">24</span></em>, <em class="sig-param"><span class="n">ent_conv</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.005</span></em>, <em class="sig-param"><span class="n">ent_conv_max</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">S_inc</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">spin</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">plot</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.asf.fas_no_guess" title="Permalink to this definition">Â¶</a></dt>
<dd><p>A simple wrapper for active space search.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> (<em>object</em>) â A converged meanfield object.</p></li>
<li><p><strong>nat_type</strong> (<em>str</em>) â Type of the natural orbitals.
âMP2â, âCISDâ and âCCSDâ.</p></li>
<li><p><strong>machine_limit</strong> (<em>int</em>) â Maximum allowed selection.</p></li>
<li><p><strong>symm</strong> (<em>str</em>) â Symmetry of the wavefunction. [âA1â. âB1â] for 2 roots.
Must be provided if symmetry is used!</p></li>
<li><p><strong>nroots</strong> (<em>int</em>) â The number of roots to be calculated.
We do two sepaerate calculattions.
This will return lists per root.
Two active spaces, two natural orbitals etc.</p></li>
<li><p><strong>Th_auto_nat</strong> (<em>str</em>) â Type of automatic threshold selection for
natural orbitals.</p></li>
<li><p><strong>Th_auto_DMRG</strong> (<em>str</em>) â Type of automatic threshold selection for
DMRG entropies.</p></li>
<li><p><strong>converge</strong> (<em>bool</em>) â This function is for development purpose.
This feature is not rigorously tested.</p></li>
<li><p><strong>add_orb_id</strong> (<em>list</em>) â Set if you want a set of specific orbitals
To be included in DMRG calculations.
[4,5]</p></li>
<li><p><strong>Ms</strong> (<em>list</em>) â List of M values for DMRG.
Set the StartM with DMRG_SM if necessary.</p></li>
<li><p><strong>MaxM</strong> (<em>int</em>) â Will change the MaxM when using the converge function.</p></li>
<li><p><strong>init_M</strong> (<em>int</em>) â Starting M value, when using the converge function.</p></li>
<li><p><strong>init_S</strong> (<em>int</em>) â Starting S value, when using the converge function.</p></li>
<li><p><strong>Max_iter</strong> (<em>int</em>) â Maximum number of iterations, when using converge.</p></li>
<li><p><strong>ent_conv</strong> (<em>float</em>) â Convergence threshold (avergae of entropies).</p></li>
<li><p><strong>ent_conv_max</strong> (<em>float</em>) â Max deviation from last step.
Default is 0 which means 5 x ent_conv.</p></li>
<li><p><strong>S_inc</strong> (<em>int</em>) â Increment for increasing sweeps.</p></li>
<li><p><strong>spin</strong> (<em>int</em>) â If set to a positive value DMRG calculations
will be carried out in that multipilicity.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) â Threshold selection plot for both natural orbitals
and entropy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The suggested active electrons.
act_mos (list):             The suggested active MOs as a list. Counting from 0.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>act_ele (int)</p>
</dd>
</dl>
<dl class="simple">
<dt>self:</dt><dd><p>init_nat (np.ndarray):      Initial CISD, MP2, etc nat orbs
initi_occ (np.ndarray):     Initial guess occupations.
AVG (list):                 AVG convergence.
ent (list):                 ent during convergence.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>TypeError</strong> â Read the errors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="asf.asf.find_active_space">
<code class="sig-name descname">find_active_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span></em>, <em class="sig-param"><span class="n">el</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">orbs</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>list<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">mo</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">occup</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">singles</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.13</span></em>, <em class="sig-param"><span class="n">plot</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">vis_mos</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">symm</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">save_entropy</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_occ</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">Th_auto</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'HQS'</span></em>, <em class="sig-param"><span class="n">Dsym</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">qfalse</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">Th_reduce</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">del_temp_</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">entropies</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">homo_lumo</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.asf.find_active_space" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Main function of this module which performs an active space guess
based on a quick and dirty 1/2RDM calculation via DMRGCI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>object</em>) â An instance of pyscf mol class.</p></li>
<li><p><strong>el</strong> (<em>int</em>) â Number of electrons. Use orbs_el_n to find number of
elecrons in a list.</p></li>
<li><p><strong>orbs</strong> (<em>int/list</em>) â Is the active space of the large DMRGCI calculation
Either int or [list of orbitals].
I expect counting from 0.</p></li>
<li><p><strong>mo</strong> (<em>np.ndarray</em>) â Molecular orbital coefficients.</p></li>
<li><p><strong>occup</strong> (<em>list</em>) â Orbital occupation.
Required for singles option if not given a fake
occupation is made using molâs spin.</p></li>
<li><p><strong>nroots</strong> (<em>int</em>) â The number of roots to be calculated.
We do two sepaerate calculattions.
This will return lists per root.
Two active spaces, two natural orbitals etc.</p></li>
<li><p><strong>singles</strong> (<em>bool</em>) â Singly occupied orbitals are considered active.
Change at your own peril.</p></li>
<li><p><strong>homo_lumo</strong> (<em>bool</em>) â Add humo and lomo orbitals to the selection.
The selection is only for occup value you enter.
Only for groundstate. (As we donât have excited
state occupation. This will change in next realease.)</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) â Threshold single site entropy which defines the border
between active and inactive MOs.
The standard value is 0.13.
There is a trigger which redefines the threshold.
Then Thresholds will be defined by the software
automatically. You can Change this by setting Th_auto to
âNoneâ.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) â If set to âTrueâ the calculated MO single site entropies
will be plotted (âplot_selectionâ will be executed).</p></li>
<li><p><strong>vis_mos</strong> (<em>bool</em>) â If set to âTrueâ the active MOs will be plotted to PNG
files via Jmol. For this, Jmol has to be installed on
your System and in your $PATH!</p></li>
<li><p><strong>symm</strong> (<em>str</em>) â Symmetry of the wavefunction. [âA1â,âB1] for 2 roots.
Must be provided if symmetry is used!</p></li>
<li><p><strong>save_entropy</strong> (<em>bool</em>) â Save the entropies a csv file (entropies).
File name can be changed by setting filename_ent in
init.</p></li>
<li><p><strong>save_occ</strong> (<em>bool</em>) â If set to True, a .csv file (ânat_occâ) with
File name can be changed by setting filename_nat in
init.
Set to a string if you want to specify the file name.</p></li>
<li><p><strong>Th_auto</strong> (<em>str</em>) â Automatic derivation  of thresholds.
âHQSâ default.
âSTDâ stanorredard deviation is used.
âAVGâ average value is used (recommended for closed
shell systems).
âMaxâ selects the max value.
âNoneâ uses the Threshold value (default 0.13).
Case insensitive.</p></li>
<li><p><strong>Dsym</strong> (<em>bool</em>) â Force disable symmetry.</p></li>
<li><p><strong>qfalse</strong> (<em>bool</em>) â Not to quit after active space selection failure.</p></li>
<li><p><strong>Th_reduce</strong> (<em>float</em>) â Howmuch to reduce threshold by until correct
active space is found.</p></li>
<li><p><strong>del_temp</strong> (<em>bool</em>) â Remove temporary files made by Block and interface.</p></li>
<li><p><strong>entropies</strong> (<em>list</em>) â Manually enter entropies will skip DMRG calculations.
Same as self.entropies.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The suggested active electrons.
act_mos (list):             The suggested active MOs as a list. Counting from 0.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>act_ele (int)</p>
</dd>
</dl>
<dl class="simple">
<dt>self:</dt><dd><p>mc (object):                PySCF MC object.
no (list):                  List of natural orbitals for each root.
occ (list):                 List of natural orbital occupations for each root.
mo_entropies (list):        MO entropies.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> â Sum of natural orbital occupations does not match total number of
    electrons.</p></li>
<li><p><strong>TypeError</strong> â look up the error.</p></li>
<li><p><strong>Exception</strong> â look up the error.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All MO indices are given back as 0-based list.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="asf.asf.reduce_orbs_n">
<code class="sig-name descname">reduce_orbs_n</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_orbs</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">nat_occ</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">score</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">machine_limit</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">max_loop</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">incr_per</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.asf.reduce_orbs_n" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Reducing the size of the active space based on occupation numbers.
Do not use the loop feature in this Version!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_orbs</strong> (<em>list</em>) â Initial list of orbitals to be reduced.</p></li>
<li><p><strong>nat_occ</strong> (<em>list</em>) â Natural orbital occupation numbers.</p></li>
<li><p><strong>score</strong> (<em>list</em>) â The score each orbital made based on the threshold
values.</p></li>
<li><p><strong>machine_limit</strong> (<em>int</em>) â Maximum allowed selection.</p></li>
<li><p><strong>max_loop</strong> (<em>int</em>) â Howmany times loop to achieve enough DOMOs.
Set to 1 for no loop.</p></li>
<li><p><strong>incr_per</strong> (<em>float</em>) â Percent increase in DOMO values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>A new final active space with the number of orbitals</dt><dd><p>as machine limit.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Chosen_ones (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="asf.asf.run_dmrg">
<code class="sig-name descname">run_dmrg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span></em>, <em class="sig-param"><span class="n">mo</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">el</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">orbs_in</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>list<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">nroots</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">symm</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">del_temp_</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.asf.run_dmrg" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Function which performs a DMRG calculation using Block.
Most of the flags are set within the init!
Memory for Block is set as mol.max_memory unless defined by user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> â PySCF mol object.
You can pass the mf here but we will only grab mol
from it.</p></li>
<li><p><strong>mo</strong> (<em>np.ndarray</em>) â Orbital coefficients.</p></li>
<li><p><strong>el</strong> (<em>int</em>) â Number of electrons.</p></li>
<li><p><strong>orbs_in</strong> (<em>int/list</em>) â Number or list of orbitals.</p></li>
<li><p><strong>nroots</strong> (<em>int</em>) â Number of roots to be calculated.</p></li>
<li><p><strong>symm</strong> (<em>str</em>) â Symmetry of wavefunction.</p></li>
<li><p><strong>del_temp</strong> (<em>bool</em>) â Remove temporary files made by Block and interface.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PySCF MCSCF object.
t_taken (float):            Calculation time.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>mc (object)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> â look up the error.</p></li>
<li><p><strong>Exception</strong> â look up the error.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="asf.asf.select_mos_ent">
<code class="sig-name descname">select_mos_ent</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">entropies</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">Th_list</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">occup</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>list<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">first_active</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">test</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">singles</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">homo_lumo</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">Th_reduce</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">qfalse</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.asf.select_mos_ent" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Select MOs based on the threshold and user input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>entropies</strong> (<em>list</em>) â List of entropies per root.
[[entropies of root1], [entropies of root2]]</p></li>
<li><p><strong>Th_list</strong> (<em>list</em>) â List of selected thresholds.</p></li>
<li><p><strong>occup</strong> (<em>list</em>) â Orbital occupation.</p></li>
<li><p><strong>first_active</strong> (<em>int</em>) â index of first active orbital.</p></li>
<li><p><strong>test</strong> (<em>bool</em>) â If set to True, I will check for correction
of selected active space.</p></li>
<li><p><strong>singles</strong> (<em>bool</em>) â Singly occupied orbitals are considered active.
Change at your own peril.</p></li>
<li><p><strong>homo_lumo</strong> (<em>bool</em>) â Add humo and lomo orbitals to the selection.
The selection is only for occup value you enter.
Only for groundstate. (As we donât have excited
state occupation. This will be added in future
releases.)</p></li>
<li><p><strong>Th_reduce</strong> (<em>float</em>) â Howmuch to reduce threshold by until correct
active space is found.</p></li>
<li><p><strong>qfalse</strong> (<em>bool</em>) â Not quick after active space selection failure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Active orbitals.
act_ele (list):             Active electrons.
Th_list (list):             List of selected thresholds.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>act_mos (list)</p>
</dd>
</dl>
<dl class="simple">
<dt>self:</dt><dd><p>p_thresh (list of dict):     All the calculated thresholds.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>Exception</strong> â Selected active space is not rational.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="asf.asf.select_mos_occ">
<code class="sig-name descname">select_mos_occ</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nat_occ</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">crit</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">weight</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">we_sc</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">ptitle</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'Natural occupation'</span></em>, <em class="sig-param"><span class="n">machine_limit</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">30</span></em>, <em class="sig-param"><span class="n">max_loop</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">incr_per</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">clipping</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">Th_auto</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'HQS'</span></em>, <em class="sig-param"><span class="n">loop</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.asf.select_mos_occ" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Performs a selection of orbitals based on natural orbital occupations.
The criteria for selection is calculated automatically using calculate_criteria
function. If you wish to define your own thresholds use crit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nat_occ</strong> (<em>list</em>) â Natural orbital occupation numbers.</p></li>
<li><p><strong>crit</strong> (<em>dict</em>) â The criteria for orbital selection.
If set to None this is calculated automatically
using a method based on one of the automatic methods.
Otherwise one can set the criteria manually
in a flexible way:
âlost_occâ is the occupation lost by doubly occ. orbs.
âgained_occâ is the occupation gained by empty orbs.
âgain_lossâ is the occupation change by singly occupied
orbs.
âsinglesâ select all singly occupied orbitals
crit={
âlost_occâ:0.1,
âgained_occâ:0.1,
âgain_lossâ:0.1,
âsinglesâ:1}</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) â To plot Natural orbital selection.</p></li>
<li><p><strong>ptitle</strong> (<em>str</em>) â Title of the plot.</p></li>
<li><p><strong>weight</strong> (<em>bool</em>) â Factor in weights of occupied and unoccupied orbitals in
threshold calculation.
For criteria function only.</p></li>
<li><p><strong>we_sc</strong> (<em>float</em>) â The scale to which weight is considered.
Check the equation below.
For criteria function only.</p></li>
<li><p><strong>machine_limit</strong> (<em>int</em>) â Maximum allowed selection.</p></li>
<li><p><strong>max_loop</strong> (<em>int</em>) â Howmany times loop to achieve enough DOMOs.
for reduction function only.</p></li>
<li><p><strong>incr_per</strong> (<em>float</em>) â Percent increase in DOMO values.
for reduction function only.</p></li>
<li><p><strong>clipping</strong> (<em>bool</em>) â Clipping the very small values from the occupation list.
This helps with setting a proper threshold.
For criteria function only.</p></li>
<li><p><strong>Th_auto</strong> (<em>str</em>) â The choices of automated threshold selection.
âHQSâ default.
âSTDâ stanorredard deviation is used.
âAVGâ average value is used (recommended for closed
shell systems).
âMinâ Minimum of above.
âMaxâ Max of above.
To disable the feature assign your choice of crit.
for selecting crit see up.
For criteria function only.</p></li>
<li><p><strong>loop</strong> (<em>int</em>) â Loop iteration for appropriation balance of empty
and occupied orbitals. Please, do not use this feature
in this version.
For reduction function only.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of selected orbitals.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Chosen_ones (np.ndarray)</p>
</dd>
</dl>
<dl class="simple">
<dt>Self:</dt><dd><p>diff (np.ndarray):          Occupation difference with HF.
crit (dict):                Automatically selected threshold.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TypeError</strong> â look up error.</p></li>
<li><p><strong>Exception</strong> â look up error.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="asf.asf.select_mroot_AS">
<code class="sig-name descname">select_mroot_AS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mos</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">base</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#asf.asf.select_mroot_AS" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Selection of active space based on several active spaces *(roots).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mos</strong> (<em>list</em>) â List of lists of active spaces.
idx should be starting from 0.</p></li>
<li><p><strong>base</strong> (<em>int</em>) â Start counting orbitals from 0.
Change to 1 if you want to feed this
directyly to sort_mo functinon of pyscf.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecular orbitals of the final active space.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>mos (list)</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Assuming the calculations have been performed on the same active space
size. All orbitals in all calculations should be identical or
at least very similar.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="asf.asf.threshold_set">
<code class="sig-name descname">threshold_set</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">entropies</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">Th_auto</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'Max'</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.13</span></em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#asf.asf.threshold_set" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calculation of entropy selection threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>entropies</strong> (<em>list</em>) â List of entropies per root.
[[entropies of root1], [entropies of root2]]</p></li>
<li><p><strong>Th_auto</strong> (<em>str</em>) â Automatic derivation of thresholds.
âHQSâ default.
âSTDâ stanorredard deviation is used.
âAVGâ average value is used.
âMaxâ selects the max value.
âNoneâ uses the Threshold value (default 0.13).
Case insensitive.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) â Threshold single site entropy which defines the border
between active and inactive MOs.
The standard value is 0.13.
There is trigger which redefines the threshold.
Then Thresholds will be defined by the software
automatically. You can Change this by setting Th_auto to
âNoneâ.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of thresholds selected per root.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Th_list (list)</p>
</dd>
</dl>
<dl class="simple">
<dt>self:</dt><dd><p>p_thresh(list of dict):     All the calculated thresholds.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>Exception</strong> â Th_auto not recognized.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-asf.utility"></span><dl class="py function">
<dt id="asf.utility.AS_compare">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">AS_compare</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mos</span><span class="p">:</span> <span class="n">list</span></em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#asf.utility.AS_compare" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compares different active spaces (list of lists) of the same size
and checks if they are identical.
Will sort the lists. You can input as many number of lists as you want.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mos</strong> (<em>list</em>) â The list of active spaces.
example: [[3, 4, 5], [3, 4, 5], [5, 4, 3]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True or False.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.AS_true">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">AS_true</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">occ</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">orbs</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">tol</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1e-12</span></em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#asf.utility.AS_true" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Check if the active space makes sense.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occ</strong> (<em>array</em>) â Orbital occupation.</p></li>
<li><p><strong>orbs</strong> (<em>list</em>) â Orbital list.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) â numerical 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>True, Good active space.</dt><dd><p>False, Bad active space.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(bool)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.act_fao">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">act_fao</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">occ</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ele</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; int<a class="headerlink" href="#asf.utility.act_fao" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Find number of first active orbital based on occupation numbers.
The first one to be inside the active space.
Counting from 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occ</strong> (<em>list</em>) â Occupation list.
If mf object is passed it will be converted to occupation.</p></li>
<li><p><strong>ele</strong> (<em>int</em>) â Number of electrons in active space.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>First active orbital counting from 0.</dt><dd><p>The orbital number given is in the active space!</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fao (int)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> â Orbital occupations should be round.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.frozen_core">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">frozen_core</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span></em><span class="sig-paren">)</span> &#x2192; int<a class="headerlink" href="#asf.utility.frozen_core" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Takes the PySCF Mole object and tells you how many core orbitals
to freeze/keep out of the active space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>object</em>) â PySCF Mole object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of orbitals to freeze.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>freeze (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.heaviest_atom">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">heaviest_atom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span></em><span class="sig-paren">)</span> &#x2192; int<a class="headerlink" href="#asf.utility.heaviest_atom" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Takes the mol objects and returns the number of electrons on the heaviest atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>object</em>) â PySCF Mole object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of electrons of the heaviest element in the molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ele_max (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.load_csv">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">load_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>str<span class="p">]</span><a class="headerlink" href="#asf.utility.load_csv" title="Permalink to this definition">Â¶</a></dt>
<dd><p>loading a CSV file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) â name of the file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array of the loaded data.
header (str):           Header of the saved data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>load (array)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> â file name should be a string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.orbs_el_n">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">orbs_el_n</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">occ</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">orbs</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">cshell</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; int<a class="headerlink" href="#asf.utility.orbs_el_n" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Find the number of electrons in the selected orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occ</strong> (<em>list</em>) â Occupation list.
If you pass mf object I handle it.
If mf object is passed it will be converted to occupation.</p></li>
<li><p><strong>orbs</strong> (<em>list</em>) â List of orbital numbers. The list should start from 0.</p></li>
<li><p><strong>cshell</strong> (<em>bool</em>) â Counts electrons only in closed shells.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of active electrons.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>act_el (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.ovp_check">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">ovp_check</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol1</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span></em>, <em class="sig-param"><span class="n">mol2</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span></em>, <em class="sig-param"><span class="n">mo1</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mo2</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">tol</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.35</span></em>, <em class="sig-param"><span class="n">mo_range</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#asf.utility.ovp_check" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compare two sets of orbitals then return the list of orbital indices
where orbitals of the same index match whith each other.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol1</strong> (<em>object</em>) â mol of system 1.</p></li>
<li><p><strong>mol2</strong> (<em>object</em>) â mol of system 2.</p></li>
<li><p><strong>mo1</strong> (<em>np.ndarray</em>) â molecular orbitals of system 1.</p></li>
<li><p><strong>mo2</strong> (<em>np.ndarray</em>) â molecular orbitals of system 2.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) â tolerance.</p></li>
<li><p><strong>mo_range</strong> (<em>list</em>) â range of orbitals to check.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of matched orbital indices.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>match (list)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> â MO both should be of the same size.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.plot_selection">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">plot_selection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>list<span class="p">, </span>dict<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">thresholds</span><span class="p">:</span> <span class="n">dict</span></em>, <em class="sig-param"><span class="n">nroot</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">title</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'single site entropy'</span></em>, <em class="sig-param"><span class="n">xlabel</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'# MO'</span></em>, <em class="sig-param"><span class="n">ylabel</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'$S_{ss}$'</span></em>, <em class="sig-param"><span class="n">fname</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'ss_entropy_'</span></em>, <em class="sig-param"><span class="n">idxshift</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">9.0</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.1</span></em>, <em class="sig-param"><span class="n">loc</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'upper right'</span></em>, <em class="sig-param"><span class="n">fancybox</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">fontsize2</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">8.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.utility.plot_selection" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Function to plot a set of point (orbital entropies, natural occupation)
with a set of thresholds (lines) to a PNG file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list/dic</em>) â List of input (one dimension, x axis will be idx).</p></li>
<li><p><strong>thresholds</strong> (<em>dict</em>) â dictionary of thresholds.
key is title of threshold, value is the float.</p></li>
<li><p><strong>nroot</strong> (<em>int</em>) â Number of the root being printed.
This is an option which only affects the filename.</p></li>
<li><p><strong>title</strong> (<em>str</em>) â Title of the plot.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em>) â Label of x axis.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em>) â Label of y axis.</p></li>
<li><p><strong>fname</strong> (<em>str</em>) â Name of the file. It will be merged with root number.</p></li>
<li><p><strong>idxshift</strong> (<em>int</em>) â Shift idx of x axis.</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) â Font size in plotting.</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) â Line width in plotting.</p></li>
<li><p><strong>loc</strong> (<em>str</em>) â Placement of plot legend.</p></li>
<li><p><strong>fontsize2</strong> (<em>float</em>) â Fontsize for legend.</p></li>
<li><p><strong>fancybox</strong> (<em>bool</em>) â FancyBox option for legend.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> â thresholds is a dic of lists.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.rdm1AO2MO">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">rdm1AO2MO</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm1</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mo</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#asf.utility.rdm1AO2MO" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Convert RDM1AO to MO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdm1</strong> (<em>np.ndarray</em>) â RDM1 in AO basis.</p></li>
<li><p><strong>mo</strong> (<em>np.ndarray</em>) â MO coefficients.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RDM1 in MO basis.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rdm1 (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.rdm1MO2AO">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">rdm1MO2AO</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm1</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mo</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#asf.utility.rdm1MO2AO" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Convert RDM1MO to AO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdm1</strong> (<em>np.ndarray</em>) â RDM1 in MO basis.</p></li>
<li><p><strong>mo</strong> (<em>np.ndarray</em>) â MO coefficients.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RDM1 in AO basis.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rdm1 (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.rdm2MO2AO">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">rdm2MO2AO</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm2</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mo</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.utility.rdm2MO2AO" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Convert RDM2MO to AO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdm2</strong> (<em>np.ndarray</em>) â RDM1 in MO basis.</p></li>
<li><p><strong>mo</strong> (<em>np.ndarray</em>) â MO coefficients.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RDM1 in AO basis.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rdm2 (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.save_csv">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">save_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">array</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">header</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'data'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.utility.save_csv" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Saving a CSV file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) â Name of the file.</p></li>
<li><p><strong>array</strong> (<em>array</em>) â Array to be saved.</p></li>
<li><p><strong>header</strong> (<em>str</em>) â Header of the data file.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> â pay attention to errors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.scf_mo_occ">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">scf_mo_occ</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span></em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#asf.utility.scf_mo_occ" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Generates a fake scf like orbital occupation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>object</em>) â PySCF mol object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Orbital occupation as list of ints.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>mo_occ (list)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> â number of spin and electrons do not match</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.utility.visualize_mos">
<code class="sig-prename descclassname">asf.utility.</code><code class="sig-name descname">visualize_mos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span></em>, <em class="sig-param"><span class="n">mo_coeff</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">act_mos</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">nroot</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'act_mo'</span></em>, <em class="sig-param"><span class="n">keepmolden</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">mo_occ</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mo_ene</span><span class="p">:</span> <span class="n">list</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.utility.visualize_mos" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Function to visualize the active MOs via Jmol.
Orbitals are counted from 0!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> â The molecule in PySCFâs gto.Mole() format.</p></li>
<li><p><strong>mo_coeff</strong> (<em>np.ndarray</em>) â The MO coeff. matrix obtained via DMRG.</p></li>
<li><p><strong>act_mos</strong> (<em>list</em>) â The suggested active MOs which will be plotted.</p></li>
<li><p><strong>nroot</strong> (<em>int</em>) â Number of the root that is being plotted.
Only for purpose of naming.</p></li>
<li><p><strong>name</strong> (<em>str</em>) â Prefix of the filename for orbitals.</p></li>
<li><p><strong>keepmolden</strong> (<em>bool</em>) â Keep the molden file used for visualization.</p></li>
<li><p><strong>mo_occ</strong> (<em>list</em>) â MO_occupation to be written in molden file.</p></li>
<li><p><strong>mo_ene</strong> (<em>list</em>) â MO energy to be written in molden file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-asf.nat_orbs"></span><dl class="py function">
<dt id="asf.nat_orbs.UNOs">
<code class="sig-prename descclassname">asf.nat_orbs.</code><code class="sig-name descname">UNOs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mf</span><span class="p">:</span> <span class="n">pyscf.scf.uhf.UHF</span></em>, <em class="sig-param"><span class="n">disable_sym</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>list<span class="p">]</span><a class="headerlink" href="#asf.nat_orbs.UNOs" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calculate unrestricted natural orbitals and their occupation number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> (<em>object</em>) â PySCF mean-field object.</p></li>
<li><p><strong>disable_sym</strong> (<em>bool</em>) â Force disable symmetrizing the natural orbitals.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Natural orbital occupations.
no (np.ndarray):        Natural orbitals.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>occ (np.ndarray)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Exception</strong> â Only UHF.</p></li>
<li><p><strong>ValueError</strong> â wrong sum of occupation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.nat_orbs.asserts">
<code class="sig-prename descclassname">asf.nat_orbs.</code><code class="sig-name descname">asserts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm1</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mo</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">overlap</span><span class="p">:</span> <span class="n">numpy.ndarray</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mol</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">type</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'RHF'</span></em>, <em class="sig-param"><span class="n">mo_a</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.nat_orbs.asserts" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Check function input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdm1</strong> (<em>np.ndarray</em>) â RDM1.</p></li>
<li><p><strong>mo</strong> (<em>np.ndarray</em>) â Molecular orbitals.</p></li>
<li><p><strong>overlap</strong> (<em>np.ndarray</em>) â Method used for the calculation.</p></li>
<li><p><strong>mol</strong> (<em>object</em>) â mole object.</p></li>
<li><p><strong>type</strong> (<em>str</em>) â âRHFâ or âUHFâ</p></li>
<li><p><strong>mo_a</strong> (<em>bool</em>) â To use alpha orbitals.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mo (np.ndarray):</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rdm1 (np.ndarray)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Exception</strong> â UHF or RHF mistake.</p></li>
<li><p><strong>TypeError</strong> â arrays only in tuple, list or numpy array.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.nat_orbs.nat_orbs_obj">
<code class="sig-prename descclassname">asf.nat_orbs.</code><code class="sig-name descname">nat_orbs_obj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span></em>, <em class="sig-param"><span class="n">disable_sym</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.nat_orbs.nat_orbs_obj" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calculate natural orbitals and their occupation number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> â Any correlation methodâs PySCF object.
Tested for CISD, CCSD, MP2.</p></li>
<li><p><strong>disable_sym</strong> (<em>bool</em>) â Avoid symmetric diagonialization even if mol has
symmetry.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Natural orbital occupations.
no (np.ndarray):        Natural orbitals.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>occ (np.ndarray)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Exception</strong> â check the errors</p></li>
<li><p><strong>ValueError</strong> â wrong sum of occupation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.nat_orbs.nat_orbs_rdm1AO_rhf">
<code class="sig-prename descclassname">asf.nat_orbs.</code><code class="sig-name descname">nat_orbs_rdm1AO_rhf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm1AO</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mo</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mol</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mode</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>list<span class="p">]</span><a class="headerlink" href="#asf.nat_orbs.nat_orbs_rdm1AO_rhf" title="Permalink to this definition">Â¶</a></dt>
<dd><p>A wrapper for calculation of natural orbitals
from rdm1 in AO basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdm1AO</strong> (<em>np.ndarray</em>) â RDM1 in AO basis.</p></li>
<li><p><strong>mo</strong> (<em>np.ndarray</em>) â Molecular orbitals.</p></li>
<li><p><strong>mol</strong> (<em>object</em>) â mole object.</p></li>
<li><p><strong>mode</strong> (<em>int</em>) â Method used for the calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Natural orbitals.
occ:                    Natural occupation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>no</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> â wrong sum of occupation.</p></li>
<li><p><strong>Exception</strong> â mode2 requires more input.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.nat_orbs.nat_orbs_rdm_rhf">
<code class="sig-prename descclassname">asf.nat_orbs.</code><code class="sig-name descname">nat_orbs_rdm_rhf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm1</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mo</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mol</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">disable_sym</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">mo_a</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>list<span class="p">]</span><a class="headerlink" href="#asf.nat_orbs.nat_orbs_rdm_rhf" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Natural orbitals from rdm1 and mos both should be RHF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdm1</strong> (<em>array</em>) â 1-particle reduced density matrix in MO basis.
2-dimension (RHF)!</p></li>
<li><p><strong>mo</strong> (<em>array</em>) â Molecular orbital coefficients.</p></li>
<li><p><strong>mol</strong> (<em>object</em>) â Optional in case of symmetry.</p></li>
<li><p><strong>disable_sym</strong> (<em>bool</em>) â Avoid symmetric diagonialization even if mol has
symmetry.</p></li>
<li><p><strong>mo_a</strong> (<em>bool</em>) â Select alpha orbitals if UHF MOs were passed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Natural orbital occupations.
no (np.ndarray):            Natural orbitals.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>occ (np.ndarray)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> â wrong sum of occupation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.nat_orbs.nat_orbs_rdm_rhf_uhf_">
<code class="sig-prename descclassname">asf.nat_orbs.</code><code class="sig-name descname">nat_orbs_rdm_rhf_uhf_</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm1</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mo</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mol</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">disable_sym</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>list<span class="p">]</span><a class="headerlink" href="#asf.nat_orbs.nat_orbs_rdm_rhf_uhf_" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Avoid using this function.
If you need to use this check your natural occupation number as you
may get wrong number of electrons which look correctâ¦
Natural orbitals from rdm1 and mos both should be RHF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdm1</strong> (<em>array</em>) â 1-particle reduced density matrix in MO basis.
2-dimension (RHF)!</p></li>
<li><p><strong>mo</strong> (<em>array</em>) â Orbital coefficients.</p></li>
<li><p><strong>mol</strong> (<em>object</em>) â Optional in case of symmetry.</p></li>
<li><p><strong>disable_sym</strong> (<em>bool</em>) â Avoid symmetric diagonialization even if mol has
symmetry.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Natural orbital occupations.
no (np.ndarray):            Natural orbitals.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>occ (np.ndarray)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> â wrong sum of occupation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.nat_orbs.nat_orbs_rdm_uhf">
<code class="sig-prename descclassname">asf.nat_orbs.</code><code class="sig-name descname">nat_orbs_rdm_uhf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm1</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">overlap</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mo</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mol</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">disable_sym</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>list<span class="p">]</span><a class="headerlink" href="#asf.nat_orbs.nat_orbs_rdm_uhf" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Natural orbitals from rdm1 and mos both should be RHF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdm1</strong> (<em>array</em>) â 1-particle reduced density matrix in MO basis.
2-dimension (RHF)!</p></li>
<li><p><strong>overlap</strong> (<em>np.ndarray</em>) â Overlap matrix.</p></li>
<li><p><strong>mo</strong> (<em>array</em>) â Orbital coefficients.</p></li>
<li><p><strong>mol</strong> (<em>object</em>) â Optional in case of symmetry.</p></li>
<li><p><strong>disable_sym</strong> (<em>bool</em>) â Avoid symmetric diagonialization even if mol has
symmetry.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Natural orbital occupations.
no (np.ndarray):            Natural orbitals.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>occ (np.ndarray)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> â wrong sum of occupation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.nat_orbs.nat_orbs_singles">
<code class="sig-prename descclassname">asf.nat_orbs.</code><code class="sig-name descname">nat_orbs_singles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">occ</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">tol</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.11</span></em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#asf.nat_orbs.nat_orbs_singles" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Find singly occupied orbitals using natural orbital occupation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occ</strong> (<em>list</em>) â List of natural orbital occupation.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) â Allowed deviation from one.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>idx of singly occupied orbitals.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>singles (list)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> â enter correct type of variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="asf.nat_orbs.nat_orbs_test">
<code class="sig-prename descclassname">asf.nat_orbs.</code><code class="sig-name descname">nat_orbs_test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">occ</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">conv_tol</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1e-08</span></em>, <em class="sig-param"><span class="n">mol</span><span class="p">:</span> <span class="n">pyscf.gto.mole.Mole</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#asf.nat_orbs.nat_orbs_test" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calculate natural orbitals and their occupation number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occ</strong> (<em>np.ndarray</em>) â List of natural orbital occupation.</p></li>
<li><p><strong>conv_tol</strong> (<em>float</em>) â Tolerance.</p></li>
<li><p><strong>mol</strong> (<em>object</em>) â mol object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If the occupation numbers are correct or not.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> â occupation should be an array.</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorials/examples.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to the documentation for ASF!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Reza Shirazi, Thilo Mast

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>